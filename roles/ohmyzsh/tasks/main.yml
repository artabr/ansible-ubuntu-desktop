---

  - name: Check if oh-my-zsh already installed
    stat:
      path: "~/.oh-my-zsh/oh-my-zsh.sh"
    register: ohmyzsh_present

  - name: Download oh-my-zsh installer
    ansible.builtin.uri:
      url: https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh
      return_content: yes
    register: ohmyzsh_installer
    when: not ohmyzsh_present.stat.exists

  - name: Run oh-my-zsh installer
    ansible.builtin.shell:
      cmd: sh -s -- -y
      stdin: "{{ ohmyzsh_installer.content }}"
    when: not ohmyzsh_present.stat.exists
